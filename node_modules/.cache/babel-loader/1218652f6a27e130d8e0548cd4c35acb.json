{"ast":null,"code":"import { ADD_QUANTITY, ADD_TO_CART, REMOVE_ITEM, SUB_QUANTITY } from \"./action-types/cart-actions\";\nexport const addToCart = addedItems => {\n  return (dispatch, getState, {\n    getFirebase,\n    getFirestore\n  }) => {\n    const firestore = getFirestore();\n    const profile = getState().firebase.profile;\n    const userId = getState().firebase.auth.uid;\n    let state = getState();\n    console.log(\"cartActions: add to cart\");\n    console.log(state);\n    let itemToAdd = state.cart.addedItems.find(item => item.id === addedItems.id);\n    console.log(itemToAdd);\n\n    if (itemToAdd === undefined) {\n      addedItems.quantity = 1;\n      firestore.collection('carts').add({\n        addedItems,\n        customerFirstName: profile.firstName,\n        customerLastName: profile.lastName,\n        customerId: userId,\n        shoppedAt: new Date()\n      }).then(() => {\n        dispatch({\n          type: ADD_TO_CART,\n          addedItems\n        });\n      }).catch(err => {\n        dispatch({\n          type: \"ADD_TO_CART_ERROR\",\n          err\n        });\n      });\n    } else {\n      addedItems.quantity += 1;\n      firestore.collection('carts').add({\n        addedItems,\n        customerFirstName: profile.firstName,\n        customerLastName: profile.lastName,\n        customerId: userId,\n        shoppedAt: new Date()\n      }).then(() => {\n        dispatch({\n          type: ADD_TO_CART,\n          addedItems\n        });\n      }).catch(err => {\n        dispatch({\n          type: \"ADD_TO_CART_ERROR\",\n          err\n        });\n      });\n    }\n  };\n};\nexport const removeItem = removedItems => {\n  // console.log(\"removedItem\");\n  // console.log(removedItem);\n  // const id = removedItem.id.toString();\n  // const cartsId = document.id;\n  console.log(\"dispatch\", removedItems.addedItems.id);\n  return (dispatch, getState, {\n    getFirebase,\n    getFirestore\n  }) => {\n    const firestore = getFirestore();\n    const docID = getState().firestore.ordered.carts[0].id;\n    console.log(docID);\n    let itemToRemove = getState().cart.addedItems.find(item => item.id === removedItems.addedItems.id);\n    console.log('itemToRemove', itemToRemove); // let newItems = getState().cart.addedItems.filter(item => removedItems.addedItems.id !== item.id);\n    // if(itemToRemove){\n    //     firestore.collection('carts').doc(docID).delete().then(() => {\n    //         console.log('delete document successfully')\n    //     });\n\n    firestore.collection('carts').where('addedItems.id', '==', removedItems.id).get().then(snapshot => {\n      snapshot.forEach(doc => {\n        console.log(doc.id);\n        console.log('delete document successfully');\n      });\n    }).delete(); // }\n    // if (itemToRemove) {\n    //     firestore.collection('carts').where('addedItems.id', '==', removedItems.id)\n    //         .get().then(() => {\n    //         dispatch({type: REMOVE_ITEM, removedItems});\n    //     }).catch(err => {\n    //         console.log('delete failed');\n    //         dispatch({type: \"REMOVE_ITEM_ERROR\", err});\n    //     })\n    // }\n  };\n};\nexport const addQuantity = addQuantityItem => {\n  console.log(\"addQuantityItem:\", addQuantityItem);\n  return (dispatch, getState, {\n    getFirebase,\n    getFirestore\n  }) => {\n    const firestore = getFirestore();\n    let cartQuantity = addQuantityItem.quantity;\n    console.log('cart', cartQuantity);\n    firestore.collection('carts').where(\"addedItems.id\", '==', addQuantityItem.id).get().then(snapshot => {\n      // dispatch({type: ADD_QUANTITY, addQuantityItem});\n      snapshot.forEach(doc => {\n        // doc.data().addedItems.quantity = addQuantityItem.quantity;\n        let test = doc.data();\n        let test2 = test.addedItems;\n        console.log('test', test.addedItems);\n        dispatch({\n          type: ADD_QUANTITY,\n          addedItems: test.addedItems\n        }); // console.log(doc.id, '=>', doc.data());\n      });\n    }).catch(err => {\n      dispatch({\n        type: \"ADD_QUANTITY_ERROR\",\n        err\n      });\n    });\n  };\n};\nexport const subtractQuantity = subtractQuantityItem => {\n  return (dispatch, getState, {\n    getFirebase,\n    getFirestore\n  }) => {\n    const firestore = getFirestore();\n    firestore.collection('carts').delete({\n      customerFirstName: 'Raj',\n      customerLastName: 'Koothrappali',\n      customerId: 12345,\n      shoppedAt: new Date()\n    }).then(() => {\n      dispatch({\n        type: SUB_QUANTITY,\n        subtractQuantityItem\n      });\n    }).catch(err => {\n      dispatch({\n        type: \"SUB_QUANTITY_ERROR\",\n        err\n      });\n    });\n  };\n};","map":{"version":3,"sources":["/Users/suya/Desktop/front end study/webProjects/shopping-cart/src/components/actions/cartActions.js"],"names":["ADD_QUANTITY","ADD_TO_CART","REMOVE_ITEM","SUB_QUANTITY","addToCart","addedItems","dispatch","getState","getFirebase","getFirestore","firestore","profile","firebase","userId","auth","uid","state","console","log","itemToAdd","cart","find","item","id","undefined","quantity","collection","add","customerFirstName","firstName","customerLastName","lastName","customerId","shoppedAt","Date","then","type","catch","err","removeItem","removedItems","docID","ordered","carts","itemToRemove","where","get","snapshot","forEach","doc","delete","addQuantity","addQuantityItem","cartQuantity","test","data","test2","subtractQuantity","subtractQuantityItem"],"mappings":"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","sourcesContent":["import {ADD_QUANTITY, ADD_TO_CART, REMOVE_ITEM, SUB_QUANTITY} from \"./action-types/cart-actions\";\n\nexport const addToCart = (addedItems) => {\n    return (dispatch, getState, {getFirebase, getFirestore}) => {\n        const firestore = getFirestore();\n        const profile = getState().firebase.profile;\n        const userId = getState().firebase.auth.uid;\n        let state = getState();\n        console.log(\"cartActions: add to cart\");\n        console.log(state);\n        let itemToAdd = state.cart.addedItems.find(item => item.id === addedItems.id);\n        console.log(itemToAdd);\n        if (itemToAdd === undefined) {\n            addedItems.quantity = 1;\n            firestore.collection('carts').add({\n                addedItems,\n                customerFirstName: profile.firstName,\n                customerLastName: profile.lastName,\n                customerId: userId,\n                shoppedAt: new Date()\n            }).then(() => {\n                dispatch({type: ADD_TO_CART, addedItems});\n            }).catch(err => {\n                dispatch({type: \"ADD_TO_CART_ERROR\", err});\n            });\n        } else {\n            addedItems.quantity += 1;\n            firestore.collection('carts').add({\n                addedItems,\n                customerFirstName: profile.firstName,\n                customerLastName: profile.lastName,\n                customerId: userId,\n                shoppedAt: new Date()\n            }).then(() => {\n                dispatch({type: ADD_TO_CART, addedItems});\n            }).catch(err => {\n                dispatch({type: \"ADD_TO_CART_ERROR\", err});\n            });\n        }\n    }\n\n\n};\n\nexport const removeItem = (removedItems) => {\n    // console.log(\"removedItem\");\n    // console.log(removedItem);\n    // const id = removedItem.id.toString();\n    // const cartsId = document.id;\n    console.log(\"dispatch\", removedItems.addedItems.id);\n    return (dispatch, getState, {getFirebase, getFirestore}) => {\n        const firestore = getFirestore();\n        const docID = getState().firestore.ordered.carts[0].id;\n        console.log(docID);\n        let itemToRemove = getState().cart.addedItems.find(item => item.id === removedItems.addedItems.id);\n        console.log('itemToRemove', itemToRemove);\n        // let newItems = getState().cart.addedItems.filter(item => removedItems.addedItems.id !== item.id);\n       // if(itemToRemove){\n       //     firestore.collection('carts').doc(docID).delete().then(() => {\n       //         console.log('delete document successfully')\n       //     });\n\n        firestore.collection('carts').where('addedItems.id', '==', removedItems.id)\n            .get().then((snapshot) => {\n                snapshot.forEach((doc) => {\n                    console.log(doc.id);\n                    console.log('delete document successfully')\n                    }\n\n                )\n        }).delete()\n       // }\n\n        // if (itemToRemove) {\n        //     firestore.collection('carts').where('addedItems.id', '==', removedItems.id)\n        //         .get().then(() => {\n        //         dispatch({type: REMOVE_ITEM, removedItems});\n        //     }).catch(err => {\n        //         console.log('delete failed');\n        //         dispatch({type: \"REMOVE_ITEM_ERROR\", err});\n        //     })\n        // }\n    }\n};\n\nexport const addQuantity = (addQuantityItem) => {\n    console.log(\"addQuantityItem:\", addQuantityItem);\n    return (dispatch, getState, {getFirebase, getFirestore}) => {\n        const firestore = getFirestore();\n        let cartQuantity = addQuantityItem.quantity;\n        console.log('cart', cartQuantity);\n        firestore.collection('carts').where(\"addedItems.id\", '==', addQuantityItem.id).get(\n        ).then((snapshot) => {\n            // dispatch({type: ADD_QUANTITY, addQuantityItem});\n            snapshot.forEach((doc => {\n                // doc.data().addedItems.quantity = addQuantityItem.quantity;\n                let test = doc.data();\n                let test2 = test.addedItems;\n                console.log('test', test.addedItems);\n                dispatch({type: ADD_QUANTITY, addedItems: test.addedItems});\n                // console.log(doc.id, '=>', doc.data());\n            }))\n        }).catch(err => {\n            dispatch({type: \"ADD_QUANTITY_ERROR\", err});\n        })\n    }\n\n};\nexport const subtractQuantity = (subtractQuantityItem) => {\n    return (dispatch, getState, {getFirebase, getFirestore}) => {\n        const firestore = getFirestore();\n        firestore.collection('carts').delete({\n\n            customerFirstName: 'Raj',\n            customerLastName: 'Koothrappali',\n            customerId: 12345,\n            shoppedAt: new Date()\n        }).then(() => {\n            dispatch({type: SUB_QUANTITY, subtractQuantityItem});\n        }).catch(err => {\n            dispatch({type: \"SUB_QUANTITY_ERROR\", err});\n        })\n    }\n};\n"]},"metadata":{},"sourceType":"module"}