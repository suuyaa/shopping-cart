{"ast":null,"code":"import { ADD_QUANTITY, ADD_TO_CART, REMOVE_ITEM, SUB_QUANTITY } from \"./action-types/cart-actions\";\nexport const addToCart = addedItems => {\n  return (dispatch, getState, {\n    getFirebase,\n    getFirestore\n  }) => {\n    const firestore = getFirestore();\n    console.log(\"cartActions: add to cart\");\n    console.log(addedItems);\n    let addedItem = state.items.find(item => item.id === action.addedItems.id);\n    let existedItem = state.addedItems.find(item => action.addedItems.id === item.id);\n    console.log(\"addedItem\", addedItem); // console.log(state.addedItems);\n\n    if (existedItem) {\n      addedItem.quantity += 1; // console.log(\"11111\");\n\n      return { ...state,\n        total: state.total + addedItem.price\n      };\n    } else {\n      addedItem.quantity = 1; // console.log(\"22222\");\n\n      return { ...state,\n        addedItems: [...state.addedItems, addedItem],\n        total: state.total + addedItem.price\n      };\n    }\n\n    firestore.collection('carts').add({\n      addedItems,\n      customerFirstName: 'Raj',\n      customerLastName: 'Koothrappali',\n      customerId: 12345,\n      shoppedAt: new Date()\n    }).then(() => {\n      dispatch({\n        type: ADD_TO_CART,\n        addedItems\n      });\n    }).catch(err => {\n      dispatch({\n        type: \"ADD_TO_CART_ERROR\",\n        err\n      });\n    });\n  };\n};\nexport const removeItem = id => {\n  // console.log(\"removedItem\");\n  // console.log(removedItem);\n  // const id = removedItem.id.toString();\n  // const cartsId = document.id;\n  console.log(\"dispatch\", id);\n  return (dispatch, getState, {\n    getFirebase,\n    getFirestore\n  }) => {\n    const firestore = getFirestore();\n    firestore.collection('carts').doc(id).delete().then(() => {\n      console.log(\"deleted\");\n      dispatch({\n        type: REMOVE_ITEM,\n        id\n      });\n    }).catch(err => {\n      console.log('delete failed');\n      dispatch({\n        type: \"REMOVE_ITEM_ERROR\",\n        err\n      });\n    });\n  };\n};\nexport const addQuantity = addQuantityItem => {\n  console.log(\"addQuantityItem:\", addQuantityItem);\n  return (dispatch, getState, {\n    getFirebase,\n    getFirestore\n  }) => {\n    const firestore = getFirestore();\n    let cartQuantity = addQuantityItem.quantity;\n    console.log('cart', cartQuantity);\n    firestore.collection('carts').where(\"addedItems.id\", '==', addQuantityItem.id).get().then(snapshot => {\n      // dispatch({type: ADD_QUANTITY, addQuantityItem});\n      snapshot.forEach(doc => {\n        // doc.data().addedItems.quantity = addQuantityItem.quantity;\n        let test = doc.data();\n        let test2 = test.addedItems;\n        console.log(test.addedItems);\n        dispatch({\n          type: ADD_QUANTITY,\n          addedItems: test.addedItems\n        }); // console.log(doc.id, '=>', doc.data());\n      });\n    }).catch(err => {\n      dispatch({\n        type: \"ADD_QUANTITY_ERROR\",\n        err\n      });\n    });\n  };\n};\nexport const subtractQuantity = subtractQuantityItem => {\n  return (dispatch, getState, {\n    getFirebase,\n    getFirestore\n  }) => {\n    const firestore = getFirestore();\n    firestore.collection('carts').delete({\n      customerFirstName: 'Raj',\n      customerLastName: 'Koothrappali',\n      customerId: 12345,\n      shoppedAt: new Date()\n    }).then(() => {\n      dispatch({\n        type: SUB_QUANTITY,\n        subtractQuantityItem\n      });\n    }).catch(err => {\n      dispatch({\n        type: \"SUB_QUANTITY_ERROR\",\n        err\n      });\n    });\n  };\n};","map":{"version":3,"sources":["/Users/suya/Desktop/front end study/webProjects/shopping-cart/src/components/actions/cartActions.js"],"names":["ADD_QUANTITY","ADD_TO_CART","REMOVE_ITEM","SUB_QUANTITY","addToCart","addedItems","dispatch","getState","getFirebase","getFirestore","firestore","console","log","addedItem","state","items","find","item","id","action","existedItem","quantity","total","price","collection","add","customerFirstName","customerLastName","customerId","shoppedAt","Date","then","type","catch","err","removeItem","doc","delete","addQuantity","addQuantityItem","cartQuantity","where","get","snapshot","forEach","test","data","test2","subtractQuantity","subtractQuantityItem"],"mappings":"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","sourcesContent":["import {ADD_QUANTITY, ADD_TO_CART, REMOVE_ITEM, SUB_QUANTITY} from \"./action-types/cart-actions\";\n\nexport const addToCart = (addedItems) => {\n    return(dispatch, getState, {getFirebase, getFirestore}) => {\n        const firestore = getFirestore();\n        console.log(\"cartActions: add to cart\");\n        console.log(addedItems);\n            let addedItem = state.items.find(item => item.id === action.addedItems.id);\n            let existedItem = state.addedItems.find(item => action.addedItems.id === item.id);\n            console.log(\"addedItem\", addedItem);\n            // console.log(state.addedItems);\n            if (existedItem) {\n                addedItem.quantity += 1;\n                // console.log(\"11111\");\n                return {\n                    ...state,\n                    total: state.total + addedItem.price\n                }\n            } else {\n                addedItem.quantity = 1;\n                // console.log(\"22222\");\n                return {\n                    ...state,\n                    addedItems: [...state.addedItems, addedItem],\n                    total: state.total + addedItem.price\n                }\n\n        }\n\n        firestore.collection('carts').add({\n            addedItems,\n            customerFirstName: 'Raj',\n            customerLastName: 'Koothrappali',\n            customerId: 12345,\n            shoppedAt: new Date()\n        }).then(() => {\n            dispatch({type: ADD_TO_CART, addedItems});\n        }).catch(err => {\n            dispatch({type: \"ADD_TO_CART_ERROR\", err});\n        })\n    }\n};\n\nexport const removeItem = (id) => {\n    // console.log(\"removedItem\");\n    // console.log(removedItem);\n    // const id = removedItem.id.toString();\n    // const cartsId = document.id;\n    console.log(\"dispatch\", id);\n    return(dispatch, getState, {getFirebase, getFirestore}) => {\n        const firestore = getFirestore();\n        firestore.collection('carts').doc(id).delete().then(() => {\n            console.log(\"deleted\");\n            dispatch({type: REMOVE_ITEM, id});\n        }).catch(err => {\n            console.log('delete failed');\n            dispatch({type: \"REMOVE_ITEM_ERROR\", err});\n        })\n    }\n};\n\nexport const addQuantity = (addQuantityItem) => {\n    console.log(\"addQuantityItem:\", addQuantityItem);\n    return(dispatch, getState, {getFirebase, getFirestore}) => {\n        const firestore = getFirestore();\n        let cartQuantity = addQuantityItem.quantity;\n        console.log('cart', cartQuantity);\n        firestore.collection('carts').where(\"addedItems.id\", '==', addQuantityItem.id).get(\n            // quantity: ++cartQuantity\n        ).then((snapshot) => {\n            // dispatch({type: ADD_QUANTITY, addQuantityItem});\n            snapshot.forEach((doc => {\n                // doc.data().addedItems.quantity = addQuantityItem.quantity;\n                let test = doc.data();\n                let test2 = test.addedItems;\n                console.log(test.addedItems);\n                dispatch({type: ADD_QUANTITY, addedItems: test.addedItems});\n                // console.log(doc.id, '=>', doc.data());\n            }))\n        }).catch(err => {\n            dispatch({type: \"ADD_QUANTITY_ERROR\", err});\n        })\n    }\n\n};\nexport const subtractQuantity = (subtractQuantityItem) => {\n    return(dispatch, getState, {getFirebase, getFirestore}) => {\n        const firestore = getFirestore();\n        firestore.collection('carts').delete({\n\n            customerFirstName: 'Raj',\n            customerLastName: 'Koothrappali',\n            customerId: 12345,\n            shoppedAt: new Date()\n        }).then(() => {\n            dispatch({type: SUB_QUANTITY, subtractQuantityItem});\n        }).catch(err => {\n            dispatch({type: \"SUB_QUANTITY_ERROR\", err});\n        })\n    }\n};\n"]},"metadata":{},"sourceType":"module"}