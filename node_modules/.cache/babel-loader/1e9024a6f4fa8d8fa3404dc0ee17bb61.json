{"ast":null,"code":"import { ADD_QUANTITY, ADD_TO_CART, REMOVE_ITEM, SUB_QUANTITY } from \"./action-types/cart-actions\";\nexport const addToCart = addedItems => {\n  return (dispatch, getState, {\n    getFirebase,\n    getFirestore\n  }) => {\n    const firestore = getFirestore();\n    const firesbase = getFirebase();\n    const profile = getState().firebase.profile;\n    const userId = getState().firebase.auth.uid;\n    let state = getState(); // let docId = firestore.ordered.carts.id;\n\n    console.log(\"cartActions: add to cart\");\n    console.log(firebase);\n    let updatedId = firestore.data.carts.addedItems.id;\n    console.log('updatedId', updatedId); // state.cart.total = state.cart.total + addedItems.price;\n\n    let itemToAdd = state.cart.items.find(item => item.id === addedItems.id);\n\n    if (itemToAdd) {\n      addedItems.quantity = 1;\n      firestore.collection('carts').add({\n        addedItems,\n        customerFirstName: profile.firstName,\n        customerLastName: profile.lastName,\n        customerId: userId,\n        shoppedAt: new Date()\n      }).then(() => {\n        dispatch({\n          type: ADD_TO_CART,\n          addedItems\n        });\n      }).catch(err => {\n        dispatch({\n          type: \"ADD_TO_CART_ERROR\",\n          err\n        });\n      });\n    } else {\n      console.log('docID', firestore.ordered.carts);\n      addedItems.quantity += 1;\n      firestore.collection('carts').doc().update({\n        addedItems,\n        updatedAt: new Date()\n      }).then(() => {\n        dispatch({\n          type: ADD_TO_CART,\n          addedItems\n        });\n      }).catch(err => {\n        dispatch({\n          type: \"ADD_TO_CART_ERROR\",\n          err\n        });\n      }); // return {\n      //     ...state,\n      //     total: state.total + addedItems.price\n      // }\n    }\n\n    console.log('state', state);\n  };\n};\nexport const removeItem = id => {\n  // console.log(\"removedItem\");\n  // console.log(removedItem);\n  // const id = removedItem.id.toString();\n  // const cartsId = document.id;\n  console.log(\"dispatch\", id);\n  return (dispatch, getState, {\n    getFirebase,\n    getFirestore\n  }) => {\n    const firestore = getFirestore();\n    firestore.collection('carts').doc(id).delete().then(() => {\n      console.log(\"deleted\");\n      dispatch({\n        type: REMOVE_ITEM,\n        id\n      });\n    }).catch(err => {\n      console.log('delete failed');\n      dispatch({\n        type: \"REMOVE_ITEM_ERROR\",\n        err\n      });\n    });\n  };\n};\nexport const addQuantity = addQuantityItem => {\n  console.log(\"addQuantityItem:\", addQuantityItem);\n  return (dispatch, getState, {\n    getFirebase,\n    getFirestore\n  }) => {\n    const firestore = getFirestore();\n    let cartQuantity = addQuantityItem.quantity;\n    console.log('cart', cartQuantity);\n    firestore.collection('carts').where(\"addedItems.id\", '==', addQuantityItem.id).get().then(snapshot => {\n      // dispatch({type: ADD_QUANTITY, addQuantityItem});\n      snapshot.forEach(doc => {\n        // doc.data().addedItems.quantity = addQuantityItem.quantity;\n        let test = doc.data();\n        let test2 = test.addedItems;\n        console.log(test.addedItems);\n        dispatch({\n          type: ADD_QUANTITY,\n          addedItems: test.addedItems\n        }); // console.log(doc.id, '=>', doc.data());\n      });\n    }).catch(err => {\n      dispatch({\n        type: \"ADD_QUANTITY_ERROR\",\n        err\n      });\n    });\n  };\n};\nexport const subtractQuantity = subtractQuantityItem => {\n  return (dispatch, getState, {\n    getFirebase,\n    getFirestore\n  }) => {\n    const firestore = getFirestore();\n    firestore.collection('carts').delete({\n      customerFirstName: 'Raj',\n      customerLastName: 'Koothrappali',\n      customerId: 12345,\n      shoppedAt: new Date()\n    }).then(() => {\n      dispatch({\n        type: SUB_QUANTITY,\n        subtractQuantityItem\n      });\n    }).catch(err => {\n      dispatch({\n        type: \"SUB_QUANTITY_ERROR\",\n        err\n      });\n    });\n  };\n};","map":{"version":3,"sources":["/Users/suya/Desktop/front end study/webProjects/shopping-cart/src/components/actions/cartActions.js"],"names":["ADD_QUANTITY","ADD_TO_CART","REMOVE_ITEM","SUB_QUANTITY","addToCart","addedItems","dispatch","getState","getFirebase","getFirestore","firestore","firesbase","profile","firebase","userId","auth","uid","state","console","log","updatedId","data","carts","id","itemToAdd","cart","items","find","item","quantity","collection","add","customerFirstName","firstName","customerLastName","lastName","customerId","shoppedAt","Date","then","type","catch","err","ordered","doc","update","updatedAt","removeItem","delete","addQuantity","addQuantityItem","cartQuantity","where","get","snapshot","forEach","test","test2","subtractQuantity","subtractQuantityItem"],"mappings":"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","sourcesContent":["import {ADD_QUANTITY, ADD_TO_CART, REMOVE_ITEM, SUB_QUANTITY} from \"./action-types/cart-actions\";\n\nexport const addToCart = (addedItems) => {\n        return (dispatch, getState, {getFirebase, getFirestore}) => {\n            const firestore = getFirestore();\n            const firesbase = getFirebase();\n            const profile = getState().firebase.profile;\n            const userId = getState().firebase.auth.uid;\n            let state = getState();\n            // let docId = firestore.ordered.carts.id;\n            console.log(\"cartActions: add to cart\");\n            console.log(firebase);\n            let updatedId = firestore.data.carts.addedItems.id;\n            console.log('updatedId', updatedId);\n            // state.cart.total = state.cart.total + addedItems.price;\n            let itemToAdd = state.cart.items.find(item => item.id === addedItems.id);\n            if (itemToAdd) {\n                addedItems.quantity = 1;\n                firestore.collection('carts').add({\n                    addedItems,\n                    customerFirstName: profile.firstName,\n                    customerLastName: profile.lastName,\n                    customerId: userId,\n                    shoppedAt: new Date()\n                }).then(() => {\n                    dispatch({type: ADD_TO_CART, addedItems});\n                }).catch(err => {\n                    dispatch({type: \"ADD_TO_CART_ERROR\", err});\n                });\n            } else {\n                console.log('docID',firestore.ordered.carts);\n                addedItems.quantity += 1;\n                firestore.collection('carts').doc().update({\n                    addedItems,\n                    updatedAt: new Date()\n                }).then(() => {\n                    dispatch({type: ADD_TO_CART, addedItems});\n                }).catch(err => {\n                    dispatch({type: \"ADD_TO_CART_ERROR\", err});\n                });\n                // return {\n                //     ...state,\n                //     total: state.total + addedItems.price\n                // }\n            }\n            console.log('state', state);\n        }\n\n\n};\n\nexport const removeItem = (id) => {\n    // console.log(\"removedItem\");\n    // console.log(removedItem);\n    // const id = removedItem.id.toString();\n    // const cartsId = document.id;\n    console.log(\"dispatch\", id);\n    return (dispatch, getState, {getFirebase, getFirestore}) => {\n        const firestore = getFirestore();\n        firestore.collection('carts').doc(id).delete().then(() => {\n            console.log(\"deleted\");\n            dispatch({type: REMOVE_ITEM, id});\n        }).catch(err => {\n            console.log('delete failed');\n            dispatch({type: \"REMOVE_ITEM_ERROR\", err});\n        })\n    }\n};\n\nexport const addQuantity = (addQuantityItem) => {\n    console.log(\"addQuantityItem:\", addQuantityItem);\n    return (dispatch, getState, {getFirebase, getFirestore}) => {\n        const firestore = getFirestore();\n        let cartQuantity = addQuantityItem.quantity;\n        console.log('cart', cartQuantity);\n        firestore.collection('carts').where(\"addedItems.id\", '==', addQuantityItem.id).get(\n            // quantity: ++cartQuantity\n        ).then((snapshot) => {\n            // dispatch({type: ADD_QUANTITY, addQuantityItem});\n            snapshot.forEach((doc => {\n                // doc.data().addedItems.quantity = addQuantityItem.quantity;\n                let test = doc.data();\n                let test2 = test.addedItems;\n                console.log(test.addedItems);\n                dispatch({type: ADD_QUANTITY, addedItems: test.addedItems});\n                // console.log(doc.id, '=>', doc.data());\n            }))\n        }).catch(err => {\n            dispatch({type: \"ADD_QUANTITY_ERROR\", err});\n        })\n    }\n\n};\nexport const subtractQuantity = (subtractQuantityItem) => {\n    return (dispatch, getState, {getFirebase, getFirestore}) => {\n        const firestore = getFirestore();\n        firestore.collection('carts').delete({\n\n            customerFirstName: 'Raj',\n            customerLastName: 'Koothrappali',\n            customerId: 12345,\n            shoppedAt: new Date()\n        }).then(() => {\n            dispatch({type: SUB_QUANTITY, subtractQuantityItem});\n        }).catch(err => {\n            dispatch({type: \"SUB_QUANTITY_ERROR\", err});\n        })\n    }\n};\n"]},"metadata":{},"sourceType":"module"}